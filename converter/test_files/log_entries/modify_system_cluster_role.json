{"Entry":{"Timestamp":"2020-01-11T01:09:30.796741Z","Severity":0,"Payload":{"service_name":"k8s.io","method_name":"io.k8s.authorization.rbac.v1.clusterroles.patch","resource_name":"rbac.authorization.k8s.io/v1/clusterroles/system:node-problem-detector","status":{},"authentication_info":{"principal_email":"mark.stemm@sysdig.com"},"authorization_info":[{"resource":"rbac.authorization.k8s.io/v1/clusterroles/system:node-problem-detector","permission":"io.k8s.authorization.rbac.v1.clusterroles.patch","granted":true}],"request_metadata":{"caller_ip":"146.74.94.74","caller_supplied_user_agent":"kubectl/v1.11.10 (darwin/amd64) kubernetes/7a578fe"},"request":{"fields":{"@type":{"Kind":{"StringValue":"k8s.io/Patch"}},"metadata":{"Kind":{"StructValue":{"fields":{"annotations":{"Kind":{"StructValue":{"fields":{"kubectl.kubernetes.io/last-applied-configuration":{"Kind":{"StringValue":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"ClusterRole\",\"metadata\":{\"annotations\":{\"rbac.authorization.kubernetes.io/autoupdate\":\"true\"},\"creationTimestamp\":\"2020-01-10T21:38:42Z\",\"labels\":{\"kubernetes.io/bootstrapping\":\"rbac-defaults\"},\"name\":\"system:node-problem-detector\",\"namespace\":\"\",\"resourceVersion\":\"55\",\"selfLink\":\"/apis/rbac.authorization.k8s.io/v1/clusterroles/system%3Anode-problem-detector\",\"uid\":\"92987dce-33f1-11ea-b5db-42010a800045\"},\"rules\":[{\"apiGroups\":[\"\"],\"resources\":[\"nodes\"],\"verbs\":[\"get\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"nodes/status\"],\"verbs\":[\"patch\"]},{\"apiGroups\":[\"\"],\"resources\":[\"events\"],\"verbs\":[\"create\",\"patch\",\"update\"]}]}\n"}}}}}},"namespace":{"Kind":{"StringValue":""}}}}}},"rules":{"Kind":{"ListValue":{"values":[{"Kind":{"StructValue":{"fields":{"apiGroups":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":""}}]}}},"resources":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"nodes"}}]}}},"verbs":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"get"}},{"Kind":{"StringValue":"delete"}}]}}}}}}},{"Kind":{"StructValue":{"fields":{"apiGroups":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":""}}]}}},"resources":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"nodes/status"}}]}}},"verbs":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"patch"}}]}}}}}}},{"Kind":{"StructValue":{"fields":{"apiGroups":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":""}}]}}},"resources":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"events"}}]}}},"verbs":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"create"}},{"Kind":{"StringValue":"patch"}},{"Kind":{"StringValue":"update"}}]}}}}}}}]}}}}},"response":{"fields":{"@type":{"Kind":{"StringValue":"rbac.authorization.k8s.io/v1.ClusterRole"}},"apiVersion":{"Kind":{"StringValue":"rbac.authorization.k8s.io/v1"}},"kind":{"Kind":{"StringValue":"ClusterRole"}},"metadata":{"Kind":{"StructValue":{"fields":{"annotations":{"Kind":{"StructValue":{"fields":{"kubectl.kubernetes.io/last-applied-configuration":{"Kind":{"StringValue":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"ClusterRole\",\"metadata\":{\"annotations\":{\"rbac.authorization.kubernetes.io/autoupdate\":\"true\"},\"creationTimestamp\":\"2020-01-10T21:38:42Z\",\"labels\":{\"kubernetes.io/bootstrapping\":\"rbac-defaults\"},\"name\":\"system:node-problem-detector\",\"namespace\":\"\",\"resourceVersion\":\"55\",\"selfLink\":\"/apis/rbac.authorization.k8s.io/v1/clusterroles/system%3Anode-problem-detector\",\"uid\":\"92987dce-33f1-11ea-b5db-42010a800045\"},\"rules\":[{\"apiGroups\":[\"\"],\"resources\":[\"nodes\"],\"verbs\":[\"get\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"nodes/status\"],\"verbs\":[\"patch\"]},{\"apiGroups\":[\"\"],\"resources\":[\"events\"],\"verbs\":[\"create\",\"patch\",\"update\"]}]}\n"}},"rbac.authorization.kubernetes.io/autoupdate":{"Kind":{"StringValue":"true"}}}}}},"creationTimestamp":{"Kind":{"StringValue":"2020-01-10T21:38:42Z"}},"labels":{"Kind":{"StructValue":{"fields":{"kubernetes.io/bootstrapping":{"Kind":{"StringValue":"rbac-defaults"}}}}}},"name":{"Kind":{"StringValue":"system:node-problem-detector"}},"resourceVersion":{"Kind":{"StringValue":"44304"}},"selfLink":{"Kind":{"StringValue":"/apis/rbac.authorization.k8s.io/v1/clusterroles/system%3Anode-problem-detector"}},"uid":{"Kind":{"StringValue":"92987dce-33f1-11ea-b5db-42010a800045"}}}}}},"rules":{"Kind":{"ListValue":{"values":[{"Kind":{"StructValue":{"fields":{"apiGroups":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":""}}]}}},"resources":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"nodes"}}]}}},"verbs":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"get"}},{"Kind":{"StringValue":"delete"}}]}}}}}}},{"Kind":{"StructValue":{"fields":{"apiGroups":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":""}}]}}},"resources":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"nodes/status"}}]}}},"verbs":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"patch"}}]}}}}}}},{"Kind":{"StructValue":{"fields":{"apiGroups":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":""}}]}}},"resources":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"events"}}]}}},"verbs":{"Kind":{"ListValue":{"values":[{"Kind":{"StringValue":"create"}},{"Kind":{"StringValue":"patch"}},{"Kind":{"StringValue":"update"}}]}}}}}}}]}}}}}},"Labels":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":""},"InsertID":"4094b1f7-7257-4156-b499-07ab9d665362","HTTPRequest":null,"Operation":{"id":"4094b1f7-7257-4156-b499-07ab9d665362","producer":"k8s.io","first":true,"last":true},"LogName":"projects/mstemm-gke-audit-logs/logs/cloudaudit.googleapis.com/activity","Resource":{"type":"k8s_cluster","labels":{"cluster_name":"standard-cluster-1","location":"us-central1-a","project_id":"mstemm-gke-audit-logs"}},"Trace":"","SpanID":"","TraceSampled":false,"SourceLocation":null},"AuditPayload":"{\"serviceName\":\"k8s.io\",\"methodName\":\"io.k8s.authorization.rbac.v1.clusterroles.patch\",\"resourceName\":\"rbac.authorization.k8s.io/v1/clusterroles/system:node-problem-detector\",\"status\":{},\"authenticationInfo\":{\"principalEmail\":\"mark.stemm@sysdig.com\"},\"authorizationInfo\":[{\"resource\":\"rbac.authorization.k8s.io/v1/clusterroles/system:node-problem-detector\",\"permission\":\"io.k8s.authorization.rbac.v1.clusterroles.patch\",\"granted\":true}],\"requestMetadata\":{\"callerIp\":\"146.74.94.74\",\"callerSuppliedUserAgent\":\"kubectl/v1.11.10 (darwin/amd64) kubernetes/7a578fe\"},\"request\":{\"@type\":\"k8s.io/Patch\",\"metadata\":{\"annotations\":{\"kubectl.kubernetes.io/last-applied-configuration\":\"{\\\"apiVersion\\\":\\\"rbac.authorization.k8s.io/v1\\\",\\\"kind\\\":\\\"ClusterRole\\\",\\\"metadata\\\":{\\\"annotations\\\":{\\\"rbac.authorization.kubernetes.io/autoupdate\\\":\\\"true\\\"},\\\"creationTimestamp\\\":\\\"2020-01-10T21:38:42Z\\\",\\\"labels\\\":{\\\"kubernetes.io/bootstrapping\\\":\\\"rbac-defaults\\\"},\\\"name\\\":\\\"system:node-problem-detector\\\",\\\"namespace\\\":\\\"\\\",\\\"resourceVersion\\\":\\\"55\\\",\\\"selfLink\\\":\\\"/apis/rbac.authorization.k8s.io/v1/clusterroles/system%3Anode-problem-detector\\\",\\\"uid\\\":\\\"92987dce-33f1-11ea-b5db-42010a800045\\\"},\\\"rules\\\":[{\\\"apiGroups\\\":[\\\"\\\"],\\\"resources\\\":[\\\"nodes\\\"],\\\"verbs\\\":[\\\"get\\\",\\\"delete\\\"]},{\\\"apiGroups\\\":[\\\"\\\"],\\\"resources\\\":[\\\"nodes/status\\\"],\\\"verbs\\\":[\\\"patch\\\"]},{\\\"apiGroups\\\":[\\\"\\\"],\\\"resources\\\":[\\\"events\\\"],\\\"verbs\\\":[\\\"create\\\",\\\"patch\\\",\\\"update\\\"]}]}\\n\"},\"namespace\":\"\"},\"rules\":[{\"apiGroups\":[\"\"],\"resources\":[\"nodes\"],\"verbs\":[\"get\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"nodes/status\"],\"verbs\":[\"patch\"]},{\"apiGroups\":[\"\"],\"resources\":[\"events\"],\"verbs\":[\"create\",\"patch\",\"update\"]}]},\"response\":{\"@type\":\"rbac.authorization.k8s.io/v1.ClusterRole\",\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"ClusterRole\",\"metadata\":{\"annotations\":{\"kubectl.kubernetes.io/last-applied-configuration\":\"{\\\"apiVersion\\\":\\\"rbac.authorization.k8s.io/v1\\\",\\\"kind\\\":\\\"ClusterRole\\\",\\\"metadata\\\":{\\\"annotations\\\":{\\\"rbac.authorization.kubernetes.io/autoupdate\\\":\\\"true\\\"},\\\"creationTimestamp\\\":\\\"2020-01-10T21:38:42Z\\\",\\\"labels\\\":{\\\"kubernetes.io/bootstrapping\\\":\\\"rbac-defaults\\\"},\\\"name\\\":\\\"system:node-problem-detector\\\",\\\"namespace\\\":\\\"\\\",\\\"resourceVersion\\\":\\\"55\\\",\\\"selfLink\\\":\\\"/apis/rbac.authorization.k8s.io/v1/clusterroles/system%3Anode-problem-detector\\\",\\\"uid\\\":\\\"92987dce-33f1-11ea-b5db-42010a800045\\\"},\\\"rules\\\":[{\\\"apiGroups\\\":[\\\"\\\"],\\\"resources\\\":[\\\"nodes\\\"],\\\"verbs\\\":[\\\"get\\\",\\\"delete\\\"]},{\\\"apiGroups\\\":[\\\"\\\"],\\\"resources\\\":[\\\"nodes/status\\\"],\\\"verbs\\\":[\\\"patch\\\"]},{\\\"apiGroups\\\":[\\\"\\\"],\\\"resources\\\":[\\\"events\\\"],\\\"verbs\\\":[\\\"create\\\",\\\"patch\\\",\\\"update\\\"]}]}\\n\",\"rbac.authorization.kubernetes.io/autoupdate\":\"true\"},\"creationTimestamp\":\"2020-01-10T21:38:42Z\",\"labels\":{\"kubernetes.io/bootstrapping\":\"rbac-defaults\"},\"name\":\"system:node-problem-detector\",\"resourceVersion\":\"44304\",\"selfLink\":\"/apis/rbac.authorization.k8s.io/v1/clusterroles/system%3Anode-problem-detector\",\"uid\":\"92987dce-33f1-11ea-b5db-42010a800045\"},\"rules\":[{\"apiGroups\":[\"\"],\"resources\":[\"nodes\"],\"verbs\":[\"get\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"nodes/status\"],\"verbs\":[\"patch\"]},{\"apiGroups\":[\"\"],\"resources\":[\"events\"],\"verbs\":[\"create\",\"patch\",\"update\"]}]}}"}
